/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package wisnLoader;
 /**
 * @author Jason Ndemueda<jndemueda@intrahealth.org><ndemuedajason@gmail.com>
 * @author Pierre Kasongo<pkasongo@intrahealth.org><pierrekasongo88@gmail.com>
 * COPYRIGHT NOTICE
 * Namibian Automatic WISN Loader (NAWL), a program developed by IntraHealth International (<intrahealth@intrahealth.org>)
 * to import service statistics into the WISN tool developed by WHO (<hrhinfo@who.int>).
 * 
 * Copyright (C) 2012 IntraHealth International
 * 
 * STATEMENT OF COPYRIGHT PERMISSION
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License along with this program.  If not, see 
 * <http://www.gnu.org/licenses/>.
 * 
 */
import java.io.File;
import java.io.IOException;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;

public class CreateWatFile {
    private XMLFile xmlfile;
    private XMLDocument xmldocument;
    private LoopingXMLDocument loop;// class just to loop the xml for answers
    public ReadActivities opdDoc;
    private ReadExistingStaff existingStaffDoc;
    private ReadFacilities excelDoc;
    private List<Facility> facilities;
    private List<Activity> activities;
    private List<ExistingStaff> existingStaff;
    private int numberOfRows;
    
    private ReadProperties prop;
    
    private TemplateData data;
    
    public CreateWatFile() throws IOException{
        
        this.prop=new ReadProperties();
    }
    
    public void loadingExcelFile( String excelFileName ) throws IOException {        
        readMainFile(excelFileName);  
//        readOPD();
    }
    
    public void readMainFile(String main) throws IOException {
        excelDoc = new ReadFacilities(this.prop.getFacilitiesFileName());
        
        setFacilities(excelDoc.getFacilities());
        
        numberOfRows = excelDoc.countRows();
    }
    
    public void readOPD() throws IOException {
        
        opdDoc = new ReadActivities(this.prop.getActivitiesFileName());
        
        /*REPORT TO LOG FILE*/
        LogFile.setNumberRowsOPD(numberOfRows);
        /*END REPORT*/
        
        setActivities(opdDoc.getActivities());
        
        numberOfRows = opdDoc.countRows();
        //System.out.println(facilities[1].getInstitutionName());
    }
    
    public void readExistingStaff() throws IOException {
        existingStaffDoc = new ReadExistingStaff(prop.getStaffFileName());
        
        setExistingStaff(existingStaffDoc.getExistingStaff());
        
        numberOfRows = existingStaffDoc.countRows();
        //System.out.println(facilities[1].getInstitutionName());
    }
    
    public void enablingXMLFile(String inFileName,String outFileName,String institutionTypeDescription,String institutionType,String regionName){
        
        xmlfile = new XMLFile(inFileName, outFileName);
        
        xmlfile.readFile();
        
        xmldocument = new XMLDocument(xmlfile.getDoc(), new Template(regionName, institutionTypeDescription,institutionType));
        
//        if( xmlTemplate.compareToIgnoreCase(INSTITUTIONDESCRIPTION.DISTRICTGENERALHOSPITAL) == 0 )
//            xmldocument = new XMLDocument(xmlfile.getDoc(), new Template(INSTITUTIONDESCRIPTION.DISTRICTGENERALHOSPITAL));
//        if( xmlTemplate.compareToIgnoreCase(INSTITUTIONDESCRIPTION.PRIMARYHEALTHCENTREWITHBEDS) == 0 )
//            xmldocument = new XMLDocument(xmlfile.getDoc(), new Template(INSTITUTIONDESCRIPTION.PRIMARYHEALTHCENTREWITHBEDS));
        
        
        loop = new LoopingXMLDocument(xmlfile.getDoc());
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
    }
    
    public void changingDetailsPerFacility(Facility f){
        
        data=TemplateData.getInstance();
        
        String name=f.getInstitutionName();
        
        String regionID="";
        
        int s= data.getRegions().size();
        
        if(data.getRegions().containsKey(f.getRegion()))  
            regionID= data.getRegions().get(f.getRegion());
        
        xmldocument.changeRegion(f.getRegion(),regionID);
        
        String districtID="";
        
        if(data.getDistricts().containsKey(f.getDistrict()))  
            districtID= data.getDistricts().get(f.getDistrict());
        
        xmldocument.changeDistrict(f.getDistrict(),districtID);
        //System.out.println(f.getDistrict());
        xmldocument.changeInstitutionName(f.getInstitutionName());
        //System.out.println(f.getInstitutionName());
        String institutionTypeID="";
        
        if(data.getInstitutionTypes().containsKey(f.getType()))  
            institutionTypeID= data.getInstitutionTypes().get(f.getType());
        
        xmldocument.changeInstitutionType(f.getType(),institutionTypeID);
        
        String institutionTypeDescID="";
        
        if(data.getInstitutionTypeDescriptions().containsKey(f.getInstitutionDescription()))  
            institutionTypeDescID= data.getInstitutionTypeDescriptions().get(f.getInstitutionDescription());
        
        xmldocument.changeInstitutionDescription(f.getInstitutionDescription(),institutionTypeDescID);
        
        xmlfile.writeFile(xmldocument.getDoc());
        
        /*REPORT TO LOG FILE*/
        LogFile.increaseNumberFilesCreated();
        /*END OF REPORT*/
    }

    
    //int i, CreateWatFile f, String fileNameFormat,String regionName 
    public void processFacility(int i, CreateWatFile f,String institutionType,String institutionTypeDesc,
            String institutionName,String templateFile,String regionName) {
        
        try {
            String fileName=institutionName+"."+prop.getWISNFileExtention();
            
            String dir=institutionType;
            
            File file=new File(dir);
            
            boolean b=false;
            
            if(!file.exists()){
                
                b=file.mkdirs();
                
                if(b){
                    System.out.println("Folder "+dir+" successfully");
                }else{
                    System.out.println("Can't create folder "+dir);
                    return;
                }
            }
            //(String inFileName,String outFileName,String institutionTypeDescription,String institutionType,String regionName)
            f.enablingXMLFile(templateFile,dir+"//"+fileName, institutionTypeDesc,institutionType,regionName);
            
            f.getLoop().numberOfTickedCadres();
            
            f.getLoop().getTickedCadresIDs();
            
            f.getLoop().getAllActivitiesAllCadres();
            
            f.readOPD();
            
            List<Activity> arr = null;
            try {
                arr = f.opdDoc.getActivities(); //System.out.println("*** "+m.getFacilities()[i].getInstitutionName()+" ***\n");
            } catch (IOException ex) {
                Logger.getLogger(CreateWatFile.class.getName()).log(Level.SEVERE, null, ex);
            }
            
            /*REPORT TO LOG FILE*/
            LogFile.setFoundOPD(false);//TO TRACK IF THE OPD OF THE FACILITY IS UPDATED
            /*END REPORT*/
            
            /* TO LOOP THROUGH ALL THE ACTIVITIES IN THE OPD.xls file
            * CHECKS IF THE FACILITY IN THE all_regions.xls can be found in the OPD.xls
            * Loop the OPD.xls once per facility
            * Number of loops = number of rows in all_regions.xls * number of rows in the OPD.xls
            */
            for(int j=0;j<arr.size();j++){
                
                if( arr.get(j).getActivity() != null ){
                    if( arr.get(j).getInstitutionName().compareToIgnoreCase(f.getFacilities().get(i).getInstitutionName()) == 0){
                        if( f.getLoop().isActivityListed(arr.get(j).getCadre(), arr.get(j).getActivity())){
                            f.getLoop().changeActivity(arr.get(j).getCadre(), arr.get(j).getActivity(), arr.get(j).getValue());
                            /*REPORT*/
                            LogFile.setFoundOPD(true);//OPD OF THE FACILITY WAS CORRECTLY UPDATED
                            /*END REPORT*/
                        }
                    }
                }
            }
            
            /* TO LOOP THROUGH ALL THE ROWS IN THE ES.xls file
            * CHECKS IF THE FACILITY IN THE all_regions.xls can be found in the ES.xls
            * Loop the ES.xls once per facility
            * Number of loops = number of rows in all_regions.xls * number of rows in the ES.xls
            */
            f.readExistingStaff();
            List<ExistingStaff> arrEs = f.existingStaffDoc.getExistingStaff();
            /*REPORT TO LOG FILE*/
            LogFile.setFoundES(false);//TO TRACK IF THE EXISTING STAFF OF THE FACILITY IS UPDATED
            /*END REPORT*/
            // TO CHANGE EXISTING STAFF
            for( int j=1; j<arrEs.size(); j++ ){
                //System.out.println(arr[j].getActivity());
                if( arrEs.get(j).getInstitutionName() != null ){// IF A ROW IS NOT EMPTY
                    if( arrEs.get(j).getInstitutionName().compareToIgnoreCase(f.getFacilities().get(i).getInstitutionName()) == 0){
                        if( f.getLoop().isCadreListed(arrEs.get(j).getCadreName())){// THE FILTER WORKS!!!
                            f.getLoop().changeExistingStaff(arrEs.get(j).getCadreName(), arrEs.get(j).getValue());
                            //REPORT
                            LogFile.setFoundES(true);
                            //END REPORT
                        }
                        
                    }
                }
            }
            
            /*REPORT TO LOG FILE*/
            if( LogFile.isFoundOPD() && LogFile.isFoundES()){
                
                System.out.println((LogFile.getNumberFilesCreated() + 1)+" - "+f.getFacilities().get(i).getInstitutionName());
                LogFile.appendListOfFacilitiesCreated((LogFile.getNumberFilesCreated() + 1)+" - "+f.getFacilities().get(i).getInstitutionName());
                LogFile.increaseCountOpdUpdatedCorrectly();
                LogFile.increaseCountESUpdatedCorrectly();
                
            }else if( LogFile.isFoundOPD() && LogFile.isFoundES() == false ){
                
                System.out.println((LogFile.getNumberFilesCreated() + 1)+" - "+f.getFacilities().get(i).getInstitutionName()+ "++++++++++++++++++++++++++++++" +"\n\tExisting Staff not updated");
                LogFile.appendListOfFacilitiesCreated((LogFile.getNumberFilesCreated() + 1)+" - "+f.getFacilities().get(i).getInstitutionName()+ "++++++++++++++++++++++++++++++" +"\n\tExisting Staff not updated");
                LogFile.increaseCountOpdUpdatedCorrectly();//true
                LogFile.increaseCountESNotUpdated();//false
                
            }else if( LogFile.isFoundOPD() == false && LogFile.isFoundES()){
                
                System.out.println((LogFile.getNumberFilesCreated() + 1)+" - "+f.getFacilities().get(i).getInstitutionName()+ "******************************" +"\n\tOPD not updated");
                LogFile.appendListOfFacilitiesCreated((LogFile.getNumberFilesCreated() + 1)+" - "+f.getFacilities().get(i).getInstitutionName()+ "******************************" +"\n\tOPD not updated");
                LogFile.increaseCountOpdNotUpdated();//false
                LogFile.increaseCountESUpdatedCorrectly();//true
            }
            
            
            else if( LogFile.isFoundOPD() == false && LogFile.isFoundES() == false ){
                System.out.println((LogFile.getNumberFilesCreated() + 1)+" - "+f.getFacilities().get(i).getInstitutionName()+ "##############################" +"\n\tOPD not updated\n\tExisting Staff not updated");
                LogFile.appendListOfFacilitiesCreated((LogFile.getNumberFilesCreated() + 1)+" - "+f.getFacilities().get(i).getInstitutionName()+ "##############################" +"\n\tOPD not updated\n\tExisting Staff not updated");
                LogFile.increaseCountOpdNotUpdated();//false
                LogFile.increaseCountESNotUpdated();//false
            }
            /*END REPORT*/
            
            f.changingDetailsPerFacility(f.getFacilities().get(i));
        } catch (IOException ex) {
            Logger.getLogger(CreateWatFile.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    
    /**
     * @return the facilities
     */
    public List<Facility> getFacilities() {
        return facilities;
    }

    /**
     * @param facilities the facilities to set
     */
    public void setFacilities(List<Facility> facilities) {
        this.facilities = facilities;
    }

    /**
     * @return the numberOfRows
     */
    public int getNumberOfRows() {
        return numberOfRows;
    }

    /**
     * @return the loop
     */
    public LoopingXMLDocument getLoop() {
        return loop;
    }

    /**
     * @return the activities
     */
    public List<Activity> getActivities() {
        return activities;
    }

    /**
     * @param activities the activities to set
     */
    public void setActivities(List<Activity> activities) {
        this.activities = activities;
    }

    /**
     * @return the existingStaffDoc
     */
    public ReadExistingStaff getExistingStaffDoc() {
        return existingStaffDoc;
    }

    /**
     * @param existingStaffDoc the existingStaffDoc to set
     */
    public void setExistingStaffDoc(ReadExistingStaff existingStaffDoc) {
        this.existingStaffDoc = existingStaffDoc;
    }

    /**
     * @return the existingStaff
     */
    public List<ExistingStaff> getExistingStaff() {
        return existingStaff;
    }

    /**
     * @param existingStaff the existingStaff to set
     */
    public void setExistingStaff(List<ExistingStaff> existingStaff) {
        this.existingStaff = existingStaff;
    }
}
